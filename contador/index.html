<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contador de Pontos Puro</title>
    <style>
        /* Variáveis de Cores */
        :root {
            --color-dark-bg: #0f172a;
            --color-header-bg: #1e293b;
            --color-primary: #4f46e5;
            --color-primary-hover: #4338ca;
            --color-text-light: #f3f4f6;
            --color-segment-border: #0f172a;
            --color-empty-slot: #374151;
            
            /* Paleta de cores para os jogadores */
            --player-1-color: #ef4444; /* Vermelho */
            --player-2-color: #3b82f6; /* Azul */
            --player-3-color: #10b981; /* Verde/Esmeralda */
            --player-4-color: #f59e0b; /* Ambar/Laranja */
        }

        /* Configurações Globais */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-dark-bg);
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header */
        header {
            background-color: var(--color-header-bg);
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: 56px;
        }

        header h1 {
            font-size: 1.25rem; /* text-xl */
            font-weight: bold;
            color: var(--color-text-light);
        }

        #reset-button {
            background-color: #ef4444;
            color: white;
            font-weight: 500;
            padding: 4px 12px;
            border: none;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background-color 0.15s, transform 0.1s;
            display: flex;
            align-items: center;
            font-size: 0.875rem;
        }

        #reset-button:hover {
            background-color: #dc2626;
        }
        
        #reset-button:active {
            transform: scale(0.95);
        }
        
        #reset-button svg {
            width: 20px;
            height: 20px;
            margin-right: 4px;
        }


        /* Área de Jogo Principal */
        #game-area {
            width: 100vw;
            /* Ocupa o restante da altura da tela */
            height: calc(100vh - 56px); 
            /* O display é manipulado pelo JS: pode ser flex ou grid */
        }
        
        /* Layout de Grid para 3 ou 4 jogadores (2x2) */
        .game-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        
        /* Layout Flex para 2 jogadores (Divisão Vertical) */
        .game-flex-col {
            display: flex;
            flex-direction: column;
        }

        /* Estilo base para cada segmento de pontuação */
        .score-segment {
            transition: background-color 0.1s, transform 0.05s, box-shadow 0.1s;
            user-select: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            border: 3px solid var(--color-segment-border);
            text-align: center;
            color: white;
        }

        /* Cores de Fundo Dinâmicas */
        .player-1-bg { background-color: var(--player-1-color); }
        .player-2-bg { background-color: var(--player-2-color); }
        .player-3-bg { background-color: var(--player-3-color); }
        .player-4-bg { background-color: var(--player-4-color); }
        .empty-slot { background-color: var(--color-empty-slot); color: #9ca3af; }

        /* Estilo para segmentos ativos (clicáveis) */
        .active-segment {
            cursor: pointer;
        }
        
        /* Ocupação total de espaço para 2 jogadores (Flex) */
        .game-flex-col .score-segment {
            flex-grow: 1; 
        }

        /* Efeito de feedback ao tocar em um segmento ativo */
        .active-segment:active {
            filter: brightness(0.9);
            transform: scale(0.98); 
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5); /* Efeito de anel */
        }
        
        /* Estilos da Pontuação */
        .score-display {
            font-size: 5rem; 
            font-weight: 900;
            line-height: 1;
        }
        
        /* Estilos do Título/Nome do Jogador */
        .segment-title {
            font-size: 1.25rem; 
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--color-text-light); 
            overflow: hidden; 
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 90%;
        }

        /* --- Modal de Configuração --- */
        .modal {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.85); 
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            transition: opacity 0.3s;
        }
        
        .modal-hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .modal-content {
            background-color: #1f2937; /* bg-gray-800 */
            padding: 24px; /* Default padding */
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 600px;
            border: 2px solid var(--color-primary);
        }
        
        /* Ajuste de responsividade para telas menores */
        @media (max-width: 400px) {
            .modal-content {
                padding: 16px; /* Reduz o padding em telas pequenas */
                max-width: 95%; /* Garante que ocupe a largura total */
            }
            .modal-content h2 {
                font-size: 1.5rem; /* Título menor para telas pequenas */
            }
        }
        
        .modal-content h2 {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 800;
            color: var(--color-primary);
            margin-bottom: 1.5rem;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 1.25rem;
        }
        
        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #d1d5db;
            margin-bottom: 4px;
        }
        
        /* Estilo unificado para inputs e select */
        input[type="number"],
        input[type="text"],
        select { 
            width: 95%;
            /* Ajustado de 12px para 8px verticalmente (8px 12px) para inputs menores */
            padding: 8px 12px; 
            border: 1px solid #4b5563; /* border-gray-600 */
            border-radius: 8px;
            background-color: #111827; /* bg-gray-900 */
            color: white;
            font-size: 1rem;
            transition: border-color 0.15s, box-shadow 0.15s;
            /* Reseta o estilo nativo do select no iOS/Android */
            appearance: none;
            -webkit-appearance: none;
        }
        select{
            cursor: pointer;
        }

        input:focus,
        select:focus { /* Adicionado select */
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.5);
        }

        .player-inputs-container {
            /* Padding reduzido de 12px para 8px */
            padding: 8px;
            background-color: #374151; /* bg-gray-700 */
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
            
            /* Lógica de Grid 2x2 para inputs de nome */
            display: flex;
            flex-wrap: wrap;
            flex-direction: column;
            justify-content: space-between;
            gap: 8px; 
        }
        
        /* O título dentro do container de nomes deve ocupar toda a largura (2 colunas) */
        .player-inputs-container h3 {
             grid-column: 1 / -1; /* Ocupa da primeira à última coluna */
             font-size: 1rem;
             font-weight: 600;
             color: white;
             padding-bottom: 8px;
             margin-bottom: 8px;
             border-bottom: 1px solid #4b5563;
        }
        
        /* Remove o margin-top, pois o gap do grid já faz o espaçamento */
        .player-inputs-container div {
            margin-top: 0;
        }
        
        /* Media query para telas *muito* pequenas, revertendo para 1 coluna */
        @media (max-width: 320px) {
            .player-inputs-container {
                grid-template-columns: 1fr;
            }
        }

        .submit-button {
            width: 100%;
            background-color: var(--color-primary);
            color: white;
            font-weight: 500;
            letter-spacing: 3px;
            padding: 12px 0;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background-color 0.15s, transform 0.1s;
            font-size: 1.125rem;
        }
        
        .submit-button:hover {
            background-color: var(--color-primary-hover);
        }
        
        .submit-button:active {
            transform: scale(0.98);
        }

    </style>
</head>
<body>

    <!-- Cabeçalho -->
    <header>
        <h1>Contador de Pontos</h1>
        <button id="reset-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0110.806 6.096 1.5 1.5 0 101.523-.746 8.502 8.502 0 00-13.623-8.196V3a1 1 0 01-2 0V1a1 1 0 011-1h3zm0 16a1 1 0 00-1-1v-2.101a7.002 7.002 0 0010.806-6.096 1.5 1.5 0 101.523-.746 8.502 8.502 0 01-13.623 8.196V17a1 1 0 002 0v2a1 1 0 00-1 1h-3z" clip-rule="evenodd" />
            </svg>
            Reiniciar
        </button>
    </header>

    <!-- Área de Jogo Principal -->
    <main id="game-area"></main>

    <!-- Modal de Configuração -->
    <div id="config-modal" class="modal">
        <div class="modal-content">
            <h2>Configurar o Placar</h2>
            
            <form id="config-form">
                
                <div class="form-group">
                    <label for="num-divisions">Número de Jogadores</label>
                    <!-- SELECT box em vez de input number -->
                    <select id="num-divisions" name="numDivisions" required>
                        <option value="4">4 Jogadores (Layout 2x2 Completo)</option>
                        <option value="3">3 Jogadores (Layout 2x2 com 1 Slot Vazio)</option>
                        <option value="2">2 Jogadores (Layout 50/50 Vertical)</option>
                    </select>
                </div>

                <!-- Inputs de Nome dos Jogadores (Grid 2x2) -->
                <div id="player-names-container" class="player-inputs-container">
                    <h3>Nomes dos Jogadores</h3>
                    
                    <div id="player-input-1">
                        <label for="player-name-1">Jogador 1</label>
                        <input type="text" id="player-name-1" placeholder="Nome do Jogador 1">
                    </div>
                    <div id="player-input-2">
                        <label for="player-name-2">Jogador 2</label>
                        <input type="text" id="player-name-2" placeholder="Nome do Jogador 2">
                    </div>
                    <div id="player-input-3">
                        <label for="player-name-3">Jogador 3</label>
                        <input type="text" id="player-name-3" placeholder="Nome do Jogador 3">
                    </div>
                    <div id="player-input-4">
                        <label for="player-name-4">Jogador 4</label>
                        <input type="text" id="player-name-4" placeholder="Nome do Jogador 4">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="initial-points">Pontuação Inicial (Mínimo 1)</label>
                    <input type="number" id="initial-points" name="initialPoints" min="1" value="100" required>
                </div>

                <button type="submit" class="submit-button">
                    Iniciar
                </button>
            </form>
        </div>
    </div>

    <script>
        // Variáveis globais para o estado do jogo
        let scores = [];
        let numDivisions = 0;
        let initialPoints = 0;
        let playerNames = []; 
        
        const gameArea = document.getElementById('game-area');
        const configModal = document.getElementById('config-modal');
        const configForm = document.getElementById('config-form');
        const resetButton = document.getElementById('reset-button');
        const numDivisionsInput = document.getElementById('num-divisions');

        // Configurações para gerenciar os inputs de nome
        const nameInputConfigs = [
            { id: 'player-name-1', containerId: 'player-input-1', bgColorClass: 'player-1-bg' },
            { id: 'player-name-2', containerId: 'player-input-2', bgColorClass: 'player-2-bg' },
            { id: 'player-name-3', containerId: 'player-input-3', bgColorClass: 'player-3-bg' },
            { id: 'player-name-4', containerId: 'player-input-4', bgColorClass: 'player-4-bg' }
        ];
        

        /**
         * Lógica para mostrar/esconder campos de nome e gerenciar o atributo 'required'
         * com base no número de jogadores selecionados.
         */
        function handleDivisionChange() {
            // A leitura é feita a partir do novo elemento <select>
            const divisions = parseInt(numDivisionsInput.value);
            
            // Valida se o número é um valor válido antes de prosseguir
            // O select garante que o valor seja 2, 3 ou 4, mas é bom manter a validação
            if (isNaN(divisions) || divisions < 2 || divisions > 4) return;
            
            nameInputConfigs.forEach((config, index) => {
                const container = document.getElementById(config.containerId);
                const inputElement = document.getElementById(config.id);
                
                if (index < divisions) {
                    // Mostrar e tornar obrigatório.
                    container.style.display = 'block';
                    inputElement.setAttribute('required', 'required');
                } else {
                    // Esconder e remover obrigatório
                    container.style.display = 'none';
                    inputElement.removeAttribute('required');
                    inputElement.value = ''; 
                }
            });
        }

        /**
         * Inicializa o estado do jogo e esconde o modal de configuração.
         * @param {number} divisions - Número de partes/jogadores (2, 3 ou 4).
         * @param {number} points - Pontuação inicial.
         * @param {string[]} names - Nomes dos jogadores.
         */
        function initializeGame(divisions, points, names) {
            numDivisions = divisions;
            initialPoints = points;
            playerNames = names.slice(0, divisions); 
            
            // Inicializa a pontuação
            scores = Array(numDivisions).fill(initialPoints);
            
            // Renderiza a área de jogo com o layout correto
            renderGameArea();
            
            // Esconde o modal de configuração
            configModal.classList.add('modal-hidden');
        }

        /**
         * Renderiza as divisões do jogo (partes clicáveis) usando a lógica de Layout Correta.
         * - 2 Jgs -> Duas metades verticais iguais (Flex Column)
         * - 3/4 Jgs -> Grid 2x2. (3 Jgs + 1 Slot Vazio)
         */
        function renderGameArea() {
            gameArea.innerHTML = ''; // Limpa a área
            
            // 1. Configurações de Layout (Adicionando a classe CSS pura)
            gameArea.className = ''; // Limpa classes anteriores
            
            if (numDivisions === 2) {
                // 2 Jogadores: Flex Column (Divisão Vertical)
                gameArea.classList.add('game-flex-col');
            } else if (numDivisions >= 3 && numDivisions <= 4) {
                // 3 ou 4 Jogadores: Grid 2x2
                gameArea.classList.add('game-grid');
            }
            
            // 2. Criação dos segmentos ativos (Players)
            for (let i = 0; i < numDivisions; i++) {
                const config = nameInputConfigs[i];
                const name = playerNames[i] || `Jogador ${i + 1}`; 

                const segment = document.createElement('div');
                segment.id = `segment-${i}`;
                segment.classList.add(
                    'score-segment', 
                    'active-segment', 
                    config.bgColorClass
                );
                segment.dataset.index = i; 

                // Adiciona o conteúdo (Nome do Jogador e Pontuação)
                segment.innerHTML = `
                    <p class="segment-title">${name}</p>
                    <span class="score-display">${scores[i]}</span>
                `;

                // Adiciona o listener de toque/clique
                segment.addEventListener('click', handleSegmentClick);

                // Adiciona ao DOM
                gameArea.appendChild(segment);
            }

            // 3. Adiciona o quadrado vazio para o caso de 3 jogadores (Completa o 2x2)
            if (numDivisions === 3) {
                const emptySegment = document.createElement('div');
                emptySegment.classList.add(
                    'score-segment', 
                    'empty-slot'
                );
                emptySegment.innerHTML = `<p class="segment-title">Slot Vazio</p><span class="score-display" style="font-size: 2rem;">--</span>`;
                
                // Segmento vazio não tem listener e completa o layout 2x2
                gameArea.appendChild(emptySegment);
            }
        }

        /**
         * Manipula o clique/toque em uma divisão ativa para decrementar a pontuação.
         */
        function handleSegmentClick(event) {
            const segment = event.currentTarget;
            const index = parseInt(segment.dataset.index);
            
            if (scores[index] > 0) {
                scores[index]--;
                
                // Feedback visual: Adiciona/remove temporariamente a sombra (ring)
                segment.style.boxShadow = '0 0 0 4px rgba(255, 255, 255, 0.75)';
                setTimeout(() => {
                    segment.style.boxShadow = 'none';
                }, 100);

                // Atualiza o DOM
                const scoreDisplay = segment.querySelector('.score-display');
                if (scoreDisplay) {
                    scoreDisplay.textContent = scores[index];
                }
            } else if (scores[index] === 0) {
                 // Feedback visual quando a pontuação já é zero
                 segment.style.boxShadow = '0 0 0 4px rgba(255, 0, 0, 0.5)';
                 segment.querySelector('.score-display').textContent = '0';
                 setTimeout(() => {
                    segment.style.boxShadow = 'none';
                }, 500);
            }
        }

        // --- Event Listeners ---

        // 1. Listener para mudanças no número de jogadores (para gerenciar a visibilidade dos campos de nome)
        numDivisionsInput.addEventListener('input', handleDivisionChange);

        // 2. Envio do Formulário de Configuração
        configForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            // Lê o valor do novo elemento <select>
            const divisions = parseInt(document.getElementById('num-divisions').value);
            const points = parseInt(document.getElementById('initial-points').value);
            
            // Coleta os nomes dos jogadores
            const collectedNames = [];
            for (let i = 1; i <= divisions; i++) {
                const nameInput = document.getElementById(`player-name-${i}`);
                collectedNames.push(nameInput.value.trim() || `Jogador ${i}`); 
            }

            if (divisions >= 2 && divisions <= 4 && points >= 1) {
                initializeGame(divisions, points, collectedNames);
            } else {
                console.error("Valores de configuração inválidos.");
            }
        });

        // 3. Botão de Reiniciar
        resetButton.addEventListener('click', function() {
            // Limpa a área de jogo e mostra o modal novamente
            gameArea.innerHTML = '';
            configModal.classList.remove('modal-hidden');
            
            // Reseta os valores do formulário para o padrão e re-configura os campos de nome
            document.getElementById('num-divisions').value = 4; // Reseta o valor do select
            document.getElementById('initial-points').value = 100;
            nameInputConfigs.forEach(config => {
                document.getElementById(config.id).value = '';
            });
            handleDivisionChange();
        });

        // Inicialização: Garante que os campos de nome estejam corretos ao carregar 
        document.addEventListener('DOMContentLoaded', () => {
            handleDivisionChange(); 
        });
    </script>

</body>
</html>